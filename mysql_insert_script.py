# -*- coding: utf-8 -*-
import mysql.connector
import json

# MySQL数据库连接参数
db_config = {
    'host': 'localhost',
    'user': 'root',
    'password': 'zpz961216A',
    'database': 'finance_data'
}

# JSON数据
json_data = '''
[{"部门名称":"水上旅客运输","代码":"55111","GO":1974405.9694651375},{"部门名称":"广播电视及卫星传输服务","代码":"63122","GO":10127851.9748261534},{"部门名称":"管道运输","代码":"57115","GO":11550762.9890669379},{"部门名称":"糖及糖制品","代码":"13015","GO":12345354.8598403707},{"部门名称":"社会保障","代码":"94148","GO":13677407.6213050708},{"部门名称":"水利管理","代码":"76135","GO":13880299.9351772722},{"部门名称":"社会工作","代码":"85142","GO":15594191.1303295456},{"部门名称":"文化、办公用机械","代码":"34071","GO":17288171.3322137706},{"部门名称":"体育","代码":"89146","GO":17412780.3469702676},{"部门名称":"生态保护和环境治理","代码":"77136","GO":19565669.9340561703},{"部门名称":"新闻和出版","代码":"86143","GO":20186932.9439710453},{"部门名称":"开采辅助活动和其他采矿产品","代码":"11011","GO":20236774.422584787},{"部门名称":"金属制品、机械和设备修理服务","代码":"43097","GO":20697060.1472693719},{"部门名称":"麻、丝绢纺织及加工品","代码":"17029","GO":21794179.1345898621},{"部门名称":"农、林、牧、渔专用机械","代码":"35075","GO":23757325.343309287},{"部门名称":"毛纺织及染整精加工品","代码":"17028","GO":24137624.8767259642},{"部门名称":"航空旅客运输","代码":"56113","GO":27068707.9357327893},{"部门名称":"农药","代码":"26045","GO":27905436.8380057216},{"部门名称":"精制茶","代码":"15025","GO":28260651.3137379885},{"部门名称":"铁路旅客运输","代码":"53107","GO":30818320.2890853733},{"部门名称":"文化艺术","代码":"88145","GO":31132962.7770205066},{"部门名称":"调味品、发酵制品","代码":"14021","GO":33325408.9546585269},{"部门名称":"广播电视设备和雷达及配套设备","代码":"39090","GO":33655566.2514719889},{"部门名称":"船舶及相关装置","代码":"37080","GO":33667181.6346097663},{"部门名称":"针织或钩针编织及其制品","代码":"17030","GO":34664818.7699759454},{"部门名称":"方便食品","代码":"14019","GO":35120396.246999301},{"部门名称":"航空货物运输和运输辅助活动","代码":"56114","GO":35357666.7069547698},{"部门名称":"耐火材料制品","代码":"30059","GO":36599742.0980904177},{"部门名称":"广播、电视、电影和影视录音制作","代码":"87144","GO":36736721.6166226119},{"部门名称":"日用化学产品","代码":"26049","GO":38737371.6843274608},{"部门名称":"水的生产和供应","代码":"46100","GO":40678551.9692319185},{"部门名称":"乳制品","代码":"14020","GO":44434435.9015289992},{"部门名称":"其他制造产品","代码":"41095","GO":44660301.3045908511},{"部门名称":"视听设备","代码":"39091","GO":47756981.0962045044},{"部门名称":"铁路运输和城市轨道交通设备","代码":"37079","GO":48510773.9958329946},{"部门名称":"有色金属矿采选产品","代码":"09009","GO":49551245.6484226882},{"部门名称":"娱乐","代码":"90147","GO":50374012.0807074606},{"部门名称":"工艺美术品","代码":"24039","GO":51327418.786268279},{"部门名称":"医疗仪器设备及器械","代码":"35076a","GO":52516042.2705989927},{"部门名称":"水产加工品","代码":"13017","GO":52672092.0225369036},{"部门名称":"铁及铁合金产品","代码":"31063","GO":52905866.6818294749},{"部门名称":"锅炉及原动设备","代码":"34067","GO":56173099.9599885494},{"部门名称":"其他电子设备","代码":"39093","GO":56308439.3530082405},{"部门名称":"其他电气机械和器材","代码":"38087","GO":56547574.0396436229},{"部门名称":"煤炭加工品","代码":"25042","GO":58326653.1171498299},{"部门名称":"石墨及其他非金属矿物制品","代码":"30060","GO":59075462.9509866387},{"部门名称":"化工、木材、非金属加工专用设备","代码":"35074","GO":59142505.3763441816},{"部门名称":"林产品","代码":"02002","GO":60485059.1743034571},{"部门名称":"黑色金属矿采选产品","代码":"08008","GO":60625796.2532827109},{"部门名称":"金属加工机械","代码":"34068","GO":62798263.1322646067},{"部门名称":"饮料","代码":"15024","GO":64236376.7064417228},{"部门名称":"铁路货物运输和运输辅助活动","代码":"53108","GO":66070661.9680954292},{"部门名称":"涂料、油墨、颜料及类似产品","代码":"26046","GO":66203535.2155099586},{"部门名称":"钢","代码":"31061","GO":66447937.3757131845},{"部门名称":"肥料","代码":"26044","GO":66539516.0122452751},{"部门名称":"农、林、牧、渔服务产品","代码":"05005","GO":70298331.8522418439},{"部门名称":"鞋","代码":"19034","GO":70505455.1308103204},{"部门名称":"租赁","代码":"71130","GO":71242421.8151655644},{"部门名称":"烘炉、风机、包装等设备","代码":"34072a","GO":71276015.3170247078},{"部门名称":"陶瓷制品","代码":"30058","GO":72279615.1179726422},{"部门名称":"水上货物运输和运输辅助活动","代码":"55112","GO":72816476.0499918759},{"部门名称":"化学纤维制品","代码":"28051","GO":73181070.9658754319},{"部门名称":"其他交通运输设备","代码":"37081","GO":73835968.4021853358},{"部门名称":"电池","代码":"38085","GO":75208199.2136700749},{"部门名称":"纺织制成品","代码":"17031","GO":75967145.8364127874},{"部门名称":"物料搬运设备","代码":"34069","GO":77143876.966468513},{"部门名称":"皮革、毛皮、羽毛及其制品","代码":"19033","GO":79018502.9361179769},{"部门名称":"公共设施及土地管理","代码":"78137","GO":79718012.3391723484},{"部门名称":"燃气生产和供应","代码":"45099","GO":81271005.3323465586},{"部门名称":"住宿","代码":"61119","GO":82273887.568965897},{"部门名称":"电机","代码":"38082","GO":82632259.4673412442},{"部门名称":"非金属矿采选产品","代码":"10010","GO":83357557.3365743011},{"部门名称":"橡胶制品","代码":"29052","GO":85973282.68342112},{"部门名称":"植物油加工品","代码":"13014","GO":91144598.108904615},{"部门名称":"酒精和酒","代码":"15023","GO":93223875.9853559136},{"部门名称":"玻璃和玻璃制品","代码":"30057","GO":94756474.0416360348},{"部门名称":"印刷和记录媒介复制品","代码":"23038","GO":95795215.6880592257},{"部门名称":"仪器仪表","代码":"40094","GO":97162659.8351321667},{"部门名称":"泵、阀门、压缩机及类似机械","代码":"34070","GO":98329166.1640490741},{"部门名称":"废弃资源和废旧材料回收加工品","代码":"42096","GO":98824192.2281617671},{"部门名称":"装卸搬运和仓储","代码":"59117","GO":100109355.80509606},{"部门名称":"家具","代码":"21036","GO":101774694.7482842207},{"部门名称":"文教、体育和娱乐用品","代码":"24040","GO":102666416.9429652244},{"部门名称":"资本市场服务","代码":"67127","GO":105756139.4286549836},{"部门名称":"科技推广和应用服务","代码":"75134","GO":106361838.5487007499},{"部门名称":"烟草制品","代码":"16026","GO":106682562.8237310946},{"部门名称":"石油和天然气开采产品","代码":"07007","GO":107689567.2761699557},{"部门名称":"邮政","代码":"60118","GO":109580070.0434241593},{"部门名称":"饲料加工品","代码":"13013","GO":110454592.5194286555},{"部门名称":"蔬菜、水果、坚果和其他农副食品加工品","代码":"13018","GO":118109110.9252517968},{"部门名称":"采矿、冶金、建筑专用设备","代码":"35073","GO":118477395.0541074276},{"部门名称":"家用器具","代码":"38086","GO":127241408.3594457209},{"部门名称":"渔产品","代码":"04004","GO":128117802.4767723233},{"部门名称":"砖瓦、石材等建筑材料","代码":"30056","GO":129548547.3650747091},{"部门名称":"谷物磨制品","代码":"13012","GO":132848436.7269234806},{"部门名称":"其他专用设备","代码":"35076b","GO":133457815.7602566481},{"部门名称":"城市公共交通及公路客运","代码":"54109","GO":134695217.0423329771},{"部门名称":"其他食品","代码":"14022","GO":135238254.9697117805},{"部门名称":"其他服务","代码":"81139","GO":136337577.6628088951},{"部门名称":"水泥、石灰和石膏","代码":"30054","GO":143713366.3688827455},{"部门名称":"电线、电缆、光缆及电工器材","代码":"38084","GO":148253838.8958565891},{"部门名称":"其他通用设备","代码":"34072b","GO":149902393.5567646921},{"部门名称":"木材加工和木、竹、藤、棕、草制品","代码":"20035","GO":163638485.1612661481},{"部门名称":"居民服务","代码":"80138","GO":164000011.0596195459},{"部门名称":"合成材料","代码":"26047","GO":173515140.2109979987},{"部门名称":"信息技术服务","代码":"65125","GO":174872978.986468792},{"部门名称":"造纸和纸制品","代码":"22037","GO":178603714.9660414457},{"部门名称":"专用化学产品和炸药、火工、焰火产品","代码":"26048","GO":181960050.4407961071},{"部门名称":"屠宰及肉类加工品","代码":"13016","GO":193266650.1060547233},{"部门名称":"石膏、水泥制品及类似制品","代码":"30055","GO":197058678.6082630157},{"部门名称":"体育场馆和其他房屋建筑","代码":"47101b","GO":201059567.1351540089},{"部门名称":"多式联运和运输代理","代码":"58116","GO":205407054.7166355252},{"部门名称":"保险","代码":"68128","GO":207244792.5989655852},{"部门名称":"输配电及控制设备","代码":"38083","GO":207782974.611199826},{"部门名称":"互联网和相关服务","代码":"64123","GO":210834513.8221048117},{"部门名称":"计算机","代码":"39088","GO":212547759.0111138821},{"部门名称":"电信","代码":"63121","GO":213571172.4581710696},{"部门名称":"纺织服装服饰","代码":"18032","GO":221034634.2719441056},{"部门名称":"基础化学原料","代码":"26043","GO":227054471.5592698157},{"部门名称":"棉、化纤纺织及印染精加工品","代码":"17027","GO":230264565.8575325608},{"部门名称":"建筑装饰、装修和其他建筑服务","代码":"50104","GO":231185610.5907100439},{"部门名称":"研究和试验发展","代码":"73132","GO":231556568.1592282653},{"部门名称":"煤炭开采和洗选产品","代码":"06006","GO":235072612.0029591024},{"部门名称":"有色金属压延加工品","代码":"32065","GO":237705650.8903016448},{"部门名称":"塑料制品","代码":"29053","GO":272218296.6759770513},{"部门名称":"通信设备","代码":"39089","GO":282469782.4091576338},{"部门名称":"有色金属及其合金","代码":"32064","GO":286964371.8656816483},{"部门名称":"建筑安装","代码":"49103","GO":295009586.9948041439},{"部门名称":"医药制品","代码":"27050","GO":300056136.8032503724},{"部门名称":"其他土木工程建筑","代码":"48102b","GO":310576343.2764543295},{"部门名称":"汽车整车","代码":"36077","GO":341136916.0694650412},{"部门名称":"餐饮","代码":"62120","GO":349715872.5364592671},{"部门名称":"精炼石油和核燃料加工品","代码":"25041","GO":351006631.3577063084},{"部门名称":"软件服务","代码":"65124","GO":355836272.5844702125},{"部门名称":"畜牧产品","代码":"03003","GO":364892383.0259100199},{"部门名称":"汽车零部件及配件","代码":"36078","GO":365320544.5937895775},{"部门名称":"道路货物运输和运输辅助活动","代码":"54110","GO":403722569.1186224222},{"部门名称":"专业技术服务","代码":"74133","GO":413424030.9797161818},{"部门名称":"电子元器件","代码":"39092","GO":458620763.5265313387},{"部门名称":"卫生","代码":"84141","GO":484478006.6089777946},{"部门名称":"金属制品","代码":"33066","GO":519481674.1164629459},{"部门名称":"教育","代码":"83140","GO":532487559.1347956061},{"部门名称":"钢压延产品","代码":"31062","GO":564156136.8531366587},{"部门名称":"零售","代码":"52106","GO":642167886.0543792248},{"部门名称":"铁路、道路、隧道和桥梁工程建筑","代码":"48102a","GO":657297681.067820549},{"部门名称":"电力、热力生产和供应","代码":"44098","GO":699502565.7029743195},{"部门名称":"农产品","代码":"01001","GO":707889673.741743803},{"部门名称":"公共管理和社会组织","代码":"91149","GO":780864797.5268778801},{"部门名称":"批发","代码":"51105","GO":856346812.5051958561},{"部门名称":"商务服务","代码":"72131","GO":891320178.7935312986},{"部门名称":"货币金融和其他金融服务","代码":"66126","GO":916369223.4446229935},{"部门名称":"房地产","代码":"70129","GO":1066633480.3337857723},{"部门名称":"住宅房屋建筑","代码":"47101a","GO":1165176192.3497438431},{"部门名称":"中间投入合计","代码":"TII","GO":26990278045.4322662354},{"部门名称":"劳动者报酬","代码":"VA001","GO":null}]
'''

# 将JSON数据转换为Python对象
data = json.loads(json_data)

# 连接MySQL数据库
conn = mysql.connector.connect(**db_config)
cursor = conn.cursor()

# 遍历JSON数据并插入到MySQL表中
for item in data:
    # 构建插入数据的SQL语句
    sql = "INSERT INTO 投入产出数据 (name, code, cost) VALUES (%s, %s, %s)"
    values = (item['部门名称'], item['代码'], item['GO'])

    # 执行插入操作
    cursor.execute(sql, values)

# 提交事务
conn.commit()

# 关闭连接
cursor.close()
conn.close()
